# Oh My Kube

<p align="center">
  <strong>åœ¨çœŸå®è™šæ‹Ÿæœºä¸Šå¿«é€Ÿæ­å»ºå®Œæ•´çš„ Kubernetes ç¯å¢ƒ</strong>
</p>

<p align="center">
  ä¸­æ–‡æ–‡æ¡£ | <a href="README.md">English</a>
</p>

<p align="center">
  <a href="#æ ¸å¿ƒç‰¹æ€§">æ ¸å¿ƒç‰¹æ€§</a> â€¢
  <a href="#ä¸ºä»€ä¹ˆé€‰æ‹©-ohmykube">ä¸ºä»€ä¹ˆé€‰æ‹© OhMyKube</a> â€¢
  <a href="#å¿«é€Ÿå¼€å§‹">å¿«é€Ÿå¼€å§‹</a> â€¢
  <a href="#ä½¿ç”¨åœºæ™¯">ä½¿ç”¨åœºæ™¯</a> â€¢
  <a href="#è¯¦ç»†æ–‡æ¡£">è¯¦ç»†æ–‡æ¡£</a> â€¢
  <a href="#å‘å±•è·¯çº¿å›¾">å‘å±•è·¯çº¿å›¾</a>
</p>

OhMyKube æ˜¯ä¸€ä¸ªåŸºäºçœŸå®è™šæ‹Ÿæœºæ„å»ºçš„ Kubernetes é›†ç¾¤åˆ›å»ºå·¥å…·ï¼Œä½¿ç”¨ Lima è™šæ‹ŸåŒ–æŠ€æœ¯å’Œ kubeadmï¼Œä¾¿äºå¼€å‘è€…å¿«é€Ÿåˆ›å»ºç®€å•çš„ Kubernetes ç¯å¢ƒã€‚

## æ ¸å¿ƒç‰¹æ€§

- ğŸŒŸ **çœŸå®è™šæ‹Ÿæœº**ï¼šä½¿ç”¨ç‹¬ç«‹çš„è™šæ‹Ÿæœºè€Œéå®¹å™¨æ¥è¿è¡Œ Kubernetes èŠ‚ç‚¹ï¼Œæ›´æ¥è¿‘ç”Ÿäº§ç¯å¢ƒ
- ğŸ”„ **ä¸€é”®éƒ¨ç½²**ï¼šç®€å•çš„å‘½ä»¤è¡Œç•Œé¢ï¼Œå¿«é€Ÿåˆ›å»ºã€åˆ é™¤å’Œæ‰©å±•é›†ç¾¤
- ğŸ§© **ç½‘ç»œæ’ä»¶é€‰æ‹©**ï¼šæ”¯æŒ Flannelï¼ˆé»˜è®¤ï¼‰å’Œ Ciliumï¼Œæ»¡è¶³ä¸åŒåœºæ™¯éœ€æ±‚
- ğŸ’¾ **å­˜å‚¨é›†æˆ**ï¼šè‡ªåŠ¨å®‰è£… Local-Path-Provisioner æˆ– Rook-Ceph å­˜å‚¨ç³»ç»Ÿ
- ğŸ”Œ **è´Ÿè½½å‡è¡¡**ï¼šå†…ç½® MetalLB æä¾›çœŸæ­£çš„ LoadBalancer æœåŠ¡ä½“éªŒ
- ğŸ› ï¸ **é«˜åº¦çµæ´»**ï¼šæ”¯æŒè‡ªå®šä¹‰ kubeadm é…ç½®å’Œå¯è°ƒèŠ‚çš„èµ„æºåˆ†é…
- ğŸš€ **å¿«é€ŸèŠ‚ç‚¹ç®¡ç†**ï¼šè½»æ¾æ·»åŠ æˆ–åˆ é™¤å·¥ä½œèŠ‚ç‚¹

## ä¸ºä»€ä¹ˆé€‰æ‹© OhMyKube

åœ¨ä¼—å¤š Kubernetes å·¥å…·ä¸­ï¼ŒOhMyKube æä¾›ç‹¬ç‰¹ä»·å€¼ï¼š

| ç‰¹æ€§ | Kind/K3d/Minikube | OhMyKube | Kubespray/Sealos |
|------|----------|----------|------------------|
| ç¯å¢ƒçœŸå®æ€§ | ğŸŸ¡ å®¹å™¨æ¨¡æ‹Ÿ | ğŸŸ¢ çœŸå®è™šæ‹Ÿæœº | ğŸŸ¢ ç”Ÿäº§çº§åˆ« |
| èµ„æºéš”ç¦» | ğŸŸ¡ å®¹å™¨çº§åˆ« | ğŸŸ¢ è™šæ‹Ÿæœºçº§åˆ« | ğŸŸ¢ ç‰©ç†æœº/è™šæ‹Ÿæœºçº§åˆ« |
| æ˜“ç”¨æ€§ | ğŸŸ¢ éå¸¸ç®€å• | ğŸŸ¢ ç®€å• | ğŸŸ¡ è¾ƒå¤æ‚ |
| å¯åŠ¨é€Ÿåº¦ | ğŸŸ¢ éå¸¸å¿« | ğŸŸ¡ ä¸­ç­‰ | ğŸ”´ è¾ƒæ…¢ |
| é€‚åˆæœ¬åœ°å¼€å‘ | ğŸŸ¢ æ˜¯ | ğŸŸ¢ æ˜¯ | ğŸŸ¡ æ˜¯ä½†è¾ƒé‡ |
| æ¥è¿‘ç”Ÿäº§ç¯å¢ƒ | ğŸ”´ å·®å¼‚è¾ƒå¤§ | ğŸŸ¢ ç›¸ä¼¼ | ğŸŸ¢ ç›¸åŒ |
| ç½‘ç»œæ¨¡å‹ | ğŸŸ¡ ç®€åŒ– | ğŸŸ¢ çœŸå® | ğŸŸ¢ çœŸå® |
| å­˜å‚¨æ”¯æŒ | ğŸŸ¡ æœ‰é™ | ğŸŸ¢ å…¨é¢ | ğŸŸ¢ å…¨é¢ |
| ç¡¬ä»¶è¦æ±‚ | ğŸŸ¢ ä½ | ğŸŸ¡ ä¸­ç­‰ | ğŸ”´ é«˜ |

## å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

1. å®‰è£… [Lima](https://github.com/lima-vm/lima)
2. å®‰è£… Go 1.23.0 æˆ–æ›´é«˜ç‰ˆæœ¬

### å®‰è£…

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/monshunter/ohmykube.git
cd ohmykube

# ç¼–è¯‘å¹¶å®‰è£…
make install
```

### åŸºæœ¬ä½¿ç”¨

```bash
# åˆ›å»ºé›†ç¾¤ï¼ˆé»˜è®¤ï¼š1 ä¸ªä¸»èŠ‚ç‚¹ + 2 ä¸ªå·¥ä½œèŠ‚ç‚¹ï¼‰
ohmykube up

# æŸ¥çœ‹é›†ç¾¤çŠ¶æ€
export KUBECONFIG=~/.kube/ohmykube-config
kubectl get nodes

# åˆ é™¤é›†ç¾¤
ohmykube down
```

## ä½¿ç”¨åœºæ™¯

- **å¼€å‘å’Œæµ‹è¯•**ï¼šåœ¨ç±»ä¼¼ç”Ÿäº§ç¯å¢ƒä¸­æµ‹è¯•åº”ç”¨ç¨‹åº
- **å­¦ä¹  Kubernetes**ï¼šäº†è§£çœŸå® Kubernetes é›†ç¾¤çš„å·¥ä½œåŸç†
- **æœ¬åœ° CI/CD**ï¼šåœ¨æœ¬åœ°æ„å»ºå®Œæ•´çš„é›†æˆæµ‹è¯•ç¯å¢ƒ
- **ç½‘ç»œå’Œå­˜å‚¨ç ”ç©¶**ï¼šæµ‹è¯•ä¸åŒçš„ CNI å’Œ CSI ç»„åˆ
- **é›†ç¾¤ç®¡ç†å®è·µ**ï¼šå­¦ä¹ èŠ‚ç‚¹ç®¡ç†ã€ç»´æŠ¤å’Œæ•…éšœæ’é™¤

## è¯¦ç»†æ–‡æ¡£

### åˆ›å»ºè‡ªå®šä¹‰é›†ç¾¤

```bash
# è‡ªå®šä¹‰èŠ‚ç‚¹æ•°é‡å’Œèµ„æº
ohmykube up --workers 3 --master-cpu 4 --master-memory 8 --master-disk 20 \
            --worker-cpu 2 --worker-memory 4096 --worker-disk 10

# é€‰æ‹©ç½‘ç»œæ’ä»¶
ohmykube up --cni cilium

# é€‰æ‹©å­˜å‚¨æ’ä»¶
ohmykube up --csi rook-ceph

# ä½¿ç”¨è‡ªå®šä¹‰ kubeadm é…ç½®
ohmykube up --kubeadm-config /path/to/custom-kubeadm-config.yaml
```

### é›†ç¾¤ç®¡ç†

```bash
# æ·»åŠ èŠ‚ç‚¹
ohmykube add --cpu 2 --memory 4 --disk 20

# åˆ é™¤èŠ‚ç‚¹
ohmykube delete ohmykube-worker-2

# å¼ºåˆ¶åˆ é™¤ï¼ˆä¸å…ˆé©±é€ Podï¼‰
ohmykube delete ohmykube-worker-2 --force

# ä¸‹è½½ kubeconfig
ohmykube download-kubeconfig
```

### è‡ªå®šä¹‰ Kubeadm é…ç½®

æ‚¨å¯ä»¥æä¾›è‡ªå®šä¹‰çš„ kubeadm é…ç½®æ–‡ä»¶æ¥è¦†ç›–é»˜è®¤è®¾ç½®ã€‚æ”¯æŒä»¥ä¸‹éƒ¨åˆ†ï¼š

- InitConfiguration
- ClusterConfiguration
- KubeletConfiguration
- KubeProxyConfiguration

ç¤ºä¾‹ï¼š

```yaml
apiVersion: kubeadm.k8s.io/v1beta4
kind: InitConfiguration
nodeRegistration:
  criSocket: unix:///var/run/containerd/containerd.sock
---
apiVersion: kubeadm.k8s.io/v1beta4
kind: ClusterConfiguration
kubernetesVersion: v1.33.0
networking:
  podSubnet: 192.168.0.0/16
  serviceSubnet: 10.96.0.0/12
```

## å‘å±•è·¯çº¿å›¾

æˆ‘ä»¬æ­£åœ¨è§„åˆ’ä»¥ä¸‹åŠŸèƒ½å¢å¼ºï¼š

### å³å°†æ¨å‡º ğŸš€

- **é•œåƒç®¡ç†å¢å¼º**
  - æœ¬åœ° Harbor æ³¨å†Œè¡¨æ”¯æŒï¼ˆ`ohmykube registry`ï¼‰
  - é•œåƒåŒæ­¥å·¥å…·ï¼ˆ`ohmykube load`ï¼Œç±»ä¼¼ kind loadï¼‰
  - é•œåƒç¼“å­˜æœºåˆ¶ï¼ŒåŠ é€Ÿé›†ç¾¤åˆ›å»º

- **å¤šé›†ç¾¤ç®¡ç†**
  - é¡¹ç›®åˆå§‹åŒ–ï¼ˆ`ohmykube init`ï¼‰
  - é›†ç¾¤åˆ‡æ¢ï¼ˆ`ohmykube switch`ï¼‰
  - æ„å»ºè¿‡ç¨‹æ£€æŸ¥ç‚¹ï¼Œæ”¯æŒä¸­æ–­æ¢å¤

### ä¸­æœŸè®¡åˆ’ ğŸ”„

- **æä¾›å•†æŠ½è±¡**
  - æ”¯æŒäº‘ API è™šæ‹Ÿæœºåˆ›å»ºï¼ˆé˜¿é‡Œäº‘ã€è…¾è®¯äº‘ç­‰ï¼‰
  - æ”¯æŒæ›´å¤šæœ¬åœ°è™šæ‹ŸåŒ–å¹³å°

- **æ›´å¤šå¹³å°æ”¯æŒ**
  - æ”¹è¿›å¯¹ä¸åŒ CPU æ¶æ„çš„æ”¯æŒ
  - ä¼˜åŒ– Windows ç¯å¢ƒä½“éªŒ

### é•¿æœŸæ„¿æ™¯ ğŸŒˆ

- **æ’ä»¶ç”Ÿæ€ç³»ç»Ÿ**
  - æ’ä»¶æ‰©å±•æœºåˆ¶
  - å¸¸ç”¨æ’ä»¶é›†æˆï¼ˆç›‘æ§ã€æ—¥å¿—ã€CI/CD ç­‰ï¼‰

- **å¼€å‘è€…å·¥å…·**
  - IDE é›†æˆ
  - è°ƒè¯•å·¥å…·é“¾
  - å¼€å‘å·¥ä½œæµä¼˜åŒ–

## æ”¯æŒçš„å¹³å°

- Mac arm64ï¼ˆä¼˜å…ˆæ”¯æŒï¼‰
- Linux arm64/amd64
- å…¶ä»–å¹³å°ï¼ˆå®éªŒæ€§æ”¯æŒï¼‰

## è´¡çŒ®

æˆ‘ä»¬æ¬¢è¿å„ç§å½¢å¼çš„è´¡çŒ®ï¼Œæ— è®ºæ˜¯ä»£ç ã€æ–‡æ¡£è¿˜æ˜¯æƒ³æ³•ï¼š

- æäº¤ Issues æŠ¥å‘Šé”™è¯¯æˆ–è¯·æ±‚åŠŸèƒ½
- æäº¤ Pull Requests è´¡çŒ®ä»£ç æˆ–æ–‡æ¡£
- å‚ä¸è®¨è®ºå¹¶åˆ†äº«æ‚¨çš„ç»éªŒ
- å¸®åŠ©æµ‹è¯•æ–°åŠŸèƒ½å’Œç‰ˆæœ¬

## è®¸å¯è¯

MIT
